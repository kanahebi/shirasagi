<% value ||= nil %>
<% controller ||= false %>
<% source_cleaner_conf = Cms::SourceCleanerTemplate.site(@cur_site).and_public.to_config %>
<%= render 'cms/agents/columns/main/base', f: f, column: column, value: value, controller: controller do %>
  <%= text_area_tag("#{f.object_name}[][in_wrap][value]", value.try(:value), column.form_options.merge(id: nil, class: "html", style: "height: 400px;")) %>
  <%= html_editor ".column-value-body .html", advanced: Cms::EditorExtension.allowed?(:use, @cur_user, site: @cur_site) %>
  <%= button_tag t("cms.source_cleaner"), { type: :button, class: "btn source-cleaner" } if source_cleaner_conf[:source_cleaner].present? %>
<% end %>
<%= jquery do %>
  <% if source_cleaner_conf[:source_cleaner].present? %>
    Cms_Source_Cleaner.config = <%= raw source_cleaner_conf.to_json %>
    Cms_Source_Cleaner.render();
  <% end %>
<% end %>
